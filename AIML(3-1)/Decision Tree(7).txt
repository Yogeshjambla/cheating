import pandas as pd 
from sklearn.model_selection import train_test_split 
from sklearn.preprocessing import LabelEncoder 
from sklearn.tree import DecisionTreeClassifier, plot_tree 
from sklearn.metrics import accuracy_score, confusion_matrix,classification_report 
import matplotlib.pyplot as plt 
import seaborn as sns




df=pd.read_csv("D:\student_dataset.csv")
df['Chemistry'] = df['Chemistry'].astype(str)
label_encoder=LabelEncoder()
df['Chemistry']=label_encoder.fit_transform(df['Chemistry'])
X=df[['Physics','Math','Chemistry']]
y=df['Chemistry'] 

X_train,X_test,y_train, y_test=train_test_split(X,y,test_size=0.2,random_state=42)  
clf=DecisionTreeClassifier(random_state=42) 
clf.fit(X_train,y_train) 
y_pred=clf.predict(X_test)  
accuracy=accuracy_score(y_test, y_pred) 
conf_matrix=confusion_matrix(y_test, y_pred) 
class_report=classification_report(y_test, y_pred, target_names=label_encoder.classes_)
print("Accuracy:",accuracy) 
print("\nClassification Report:\n", class_report)  
plt.figure(figsize=(20, 10))
plot_tree(clf, feature_names=X.columns, class_names=label_encoder.classes_, filled=True, max_depth=3)
plt.title("Decision Tree Visualization (Top 3 Levels)")
plt.show()
plt.figure(figsize=(6, 5))
sns.heatmap(conf_matrix, annot=True, fmt="d", cmap="Blues",
xticklabels=label_encoder.classes_,
yticklabels=label_encoder.classes_)
plt.xlabel("Predicted")
plt.ylabel("Actual")
plt.title("Confusion Matrix")
plt.show()
